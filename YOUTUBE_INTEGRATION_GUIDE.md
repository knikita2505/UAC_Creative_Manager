# YouTube Integration Guide

## Обзор

Система UAC Creative Manager теперь поддерживает полную интеграцию с YouTube для загрузки видео с поддержкой множественных файлов, визуального выбора модалок и настройки миниатюр.

## Новые возможности

### 1. Множественная загрузка видео
- Поддержка загрузки нескольких видео одновременно
- Пакетная обработка для локальных файлов и Google Drive ссылок
- Автоматическая нумерация видео (Кампания #1, #2, и т.д.)

### 2. Визуальный выбор модалок
- Превью изображений модалок в виде сетки
- Информация о размере файла и дате загрузки
- Интерактивный выбор с визуальной обратной связью

### 3. Настройка миниатюр
- **Без изменений** - оригинальная миниатюра YouTube
- **Первый кадр** - автоматическое извлечение первого кадра
- **Кастомная с модалкой** - наложение выбранной модалки на первый кадр

### 4. Расширенный реестр
- Статистика по типам миниатюр
- Детальная информация о загрузках
- Фильтрация и поиск

## API Endpoints

### Загрузка видео

#### Одиночная загрузка
```
POST /upload/video
```

#### Пакетная загрузка
```
POST /upload/videos/batch
```

**Параметры:**
- `campaign_name` (string) - название кампании
- `video_source` (string) - "local" или "drive"
- `video_files` (files) - видео файлы (для локальной загрузки)
- `drive_urls` (string) - JSON массив ссылок (для Google Drive)
- `thumbnail_option` (string) - "none", "first_frame", "custom_modal"
- `modal_image_id` (string) - ID модалки (для кастомной миниатюры)

### Управление модалками

#### Загрузка модалки
```
POST /upload/modal
```

#### Получение списка модалок
```
GET /modals
```

#### Превью модалки
```
GET /modals/{modal_id}/preview
```

### Интеграции

#### Настройка YouTube
```
POST /integrations/youtube/setup
```

#### Тестирование YouTube
```
POST /integrations/youtube/test
```

#### Статус интеграций
```
GET /integrations/status
```

## Настройка YouTube интеграции

### 1. Получение OAuth2 credentials

1. Перейдите в [Google Cloud Console](https://console.cloud.google.com/)
2. Создайте новый проект или выберите существующий
3. Включите YouTube Data API v3
4. Создайте OAuth2 credentials:
   - Application type: Web application
   - Authorized redirect URIs: `http://localhost:8000/auth/youtube/callback`

### 2. Настройка в приложении

1. Откройте раздел "Настройки" в приложении
2. Перейдите в "Интеграции" → "YouTube"
3. Введите:
   - Client ID
   - Client Secret
   - Redirect URI: `http://localhost:8000/auth/youtube/callback`
4. Нажмите "Сохранить"
5. Нажмите "Авторизоваться" для получения доступа

### 3. Тестирование

```bash
# Запуск тестового скрипта
python test_integration.py
```

## Использование

### Загрузка одного видео

1. Откройте раздел "Загрузка видео"
2. Введите название кампании
3. Выберите источник видео (локальный файл или Google Drive)
4. Настройте миниатюру:
   - **Без изменений** - оставить оригинальную
   - **Первый кадр** - использовать первый кадр
   - **Кастомная** - выбрать модалку из списка
5. Нажмите "Загрузить на YouTube"

### Загрузка нескольких видео

1. Выберите несколько видео файлов или введите несколько ссылок на Google Drive
2. Система автоматически пронумерует видео
3. Все видео будут обработаны с одинаковыми настройками миниатюр

### Управление модалками

1. Откройте раздел "Модалки"
2. Загрузите изображения в формате JPG, PNG, GIF, WebP
3. Просматривайте превью загруженных модалок
4. Используйте модалки при создании кастомных миниатюр

## Мониторинг

### Реестр креативов

- Просмотр всех загруженных видео
- Статистика по типам миниатюр
- Фильтрация по статусу и названию
- Экспорт данных в CSV

### Логирование

Все операции логируются в базу данных:
- Успешные загрузки
- Ошибки интеграции
- Настройки модалок
- Статистика использования

## Troubleshooting

### YouTube не авторизован
1. Проверьте настройки OAuth2 credentials
2. Убедитесь, что redirect URI совпадает
3. Попробуйте повторную авторизацию

### Ошибки загрузки
1. Проверьте размер видео файлов
2. Убедитесь в корректности формата
3. Проверьте подключение к интернету

### Проблемы с модалками
1. Убедитесь, что файлы загружены корректно
2. Проверьте формат изображений
3. Очистите кэш браузера

## Безопасность

- Все API ключи хранятся в зашифрованном виде
- OAuth2 токены обновляются автоматически
- Логирование всех операций для аудита
- Валидация всех входящих файлов

## Производительность

- Пакетная обработка для множественных видео
- Асинхронная загрузка на YouTube
- Кэширование превью изображений
- Оптимизация размера файлов
